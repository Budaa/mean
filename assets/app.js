var app=angular.module("app",["ngRoute"]);angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc",function(e,t){window.localStorage.token&&t.setXAuthHeader(window.localStorage.token).then(function(t){e.$emit("login",t.data)}),e.$on("login",function(t,o){e.currentUser=o}),e.logout=function(){delete e.currentUser,delete e.posts,delete window.localStorage.token,t.logout()}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","$location",function(e,t,o){e.login=function(n,r){t.login(n,r).then(function(t){e.$emit("login",t.data),o.path("/")})}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(e,t){e.addPost=function(){e.postBody&&t.create({username:e.currentUser.username,body:e.postBody}).success(function(t){e.posts.unshift(t),e.postBody=null})},e.removePost=function(o,n){t.deletePost({id:o}).success(function(){alert("Post has been deleted"),e.posts.splice(n,1)}).error(function(e){console.log(e)})},t.fetch().success(function(t){e.posts=t}).error(function(){e.postserr="Please log in!"})}]),angular.module("app").service("PostsSvc",["$http",function(e){this.fetch=function(){return e.get("/api/posts")},this.create=function(t){return e.post("/api/posts",t)},this.deletePost=function(t){return e.put("/api/posts",t)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(e,t){e.register=function(o,n,r){return o?r==n&&r?void t.createUser(o,n).then(function(t){e.$emit("login",t.data)},function(t){e.registerError=t.data,e.username="",e.password=""}):(e.registerError="Passwords don't match",null):(e.registerError="Please, select your username.",null)}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http","$location",function(e,t){var o=this;o.getUser=function(){return e.get("/api/users")},o.login=function(t,n){return e.post("/api/sessions",{username:t,password:n}).then(function(t){return window.localStorage.token=t.data,e.defaults.headers.common["X-Auth"]=t.data,o.getUser()})},o.createUser=function(t,n){return e.post("/api/users",{username:t,password:n}).then(function(){return o.login(t,n)})},o.logout=function(){e.defaults.headers.common["X-Auth"]="",t.path("/login")},o.setXAuthHeader=function(t){return e.defaults.headers.common["X-Auth"]=t,o.getUser()}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIlVzZXJTdmMiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJ0b2tlbiIsInNldFhBdXRoSGVhZGVyIiwidGhlbiIsInVzZXIiLCIkZW1pdCIsImRhdGEiLCIkb24iLCJfIiwiY3VycmVudFVzZXIiLCJsb2dvdXQiLCJwb3N0cyIsIiRsb2NhdGlvbiIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInJlc3BvbnNlIiwicGF0aCIsIlBvc3RzU3ZjIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwiY3JlYXRlIiwiYm9keSIsInN1Y2Nlc3MiLCJwb3N0IiwidW5zaGlmdCIsInJlbW92ZVBvc3QiLCJpZCIsImluZGV4IiwiZGVsZXRlUG9zdCIsImFsZXJ0Iiwic3BsaWNlIiwiZXJyb3IiLCJlciIsImNvbnNvbGUiLCJsb2ciLCJmZXRjaCIsInBvc3RzZXJyIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsInB1dCIsInJlZ2lzdGVyIiwicGFzc3dvcmQyIiwiY3JlYXRlVXNlciIsImVyciIsInJlZ2lzdGVyRXJyb3IiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInN2YyIsImdldFVzZXIiLCJ2YWwiLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJoZWFkZXIiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsT0FDQSxXQ0RBRCxTQUFBQyxPQUFBLE9BQ0FDLFdBQUEsbUJBQUEsU0FBQSxVQUFBLFNBQUFDLEVBQUFDLEdBQ0FDLE9BQUFDLGFBQUFDLE9B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LEVBQUFQLFdBQUEsU0FBQS9CLEVBQUFDLEdBQ0EsTUFBQXdCLEdBQUFmLEtBQUEsY0FDQVYsU0FBQUEsRUFDQUMsU0FBQUEsSUFDQVosS0FBQSxXQUNBLE1BQUFpRCxHQUFBdkMsTUFBQUMsRUFBQUMsTUFJQXFDLEVBQUExQyxPQUFBLFdBQ0E2QixFQUFBZ0IsU0FBQUMsUUFBQUMsT0FBQSxVQUFBLEdBQ0E3QyxFQUFBSyxLQUFBLFdBR0FtQyxFQUFBbEQsZUFBQSxTQUFBd0QsR0FFQSxNQURBbkIsR0FBQWdCLFNBQUFDLFFBQUFDLE9BQUEsVUFBQUMsRUFDQU4sRUFBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG5cdCduZ1JvdXRlJ1xuXSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBbJyRzY29wZScsICdVc2VyU3ZjJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3ZjKXtcblx0aWYod2luZG93LmxvY2FsU3RvcmFnZS50b2tlbikge1xuXHRcdFVzZXJTdmMuc2V0WEF1dGhIZWFkZXIod2luZG93LmxvY2FsU3RvcmFnZS50b2tlbilcblx0XHRcdC50aGVuKGZ1bmN0aW9uKHVzZXIpe1xuXHRcdFx0XHQkc2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlci5kYXRhKVxuXHRcdFx0fSlcblx0fVxuXHQkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sIHVzZXIpIHtcblx0XHQkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyXG5cdH0pXG5cdCRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpIHtcblx0XHRkZWxldGUgJHNjb3BlLmN1cnJlbnRVc2VyXG5cdFx0ZGVsZXRlICRzY29wZS5wb3N0c1xuXHRcdGRlbGV0ZSB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuXG5cdFx0VXNlclN2Yy5sb2dvdXQoKVxuXHR9XG59XSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignTG9naW5DdHJsJywgWyckc2NvcGUnLCAnVXNlclN2YycsICckbG9jYXRpb24nLCBmdW5jdGlvbigkc2NvcGUsIFVzZXJTdmMsICRsb2NhdGlvbil7XG5cdCRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdFVzZXJTdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblx0XHRcdFx0JHNjb3BlLiRlbWl0KCdsb2dpbicsIHJlc3BvbnNlLmRhdGEpXG5cdFx0XHRcdCRsb2NhdGlvbi5wYXRoKCcvJylcblx0XHRcdH0pXG5cdH1cbn1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgUG9zdHNTdmMpe1xuXHQkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmKCRzY29wZS5wb3N0Qm9keSkge1xuXHRcdFx0UG9zdHNTdmMuY3JlYXRlKHtcblx0XHRcdFx0dXNlcm5hbWU6ICRzY29wZS5jdXJyZW50VXNlci51c2VybmFtZSxcblx0XHRcdFx0Ym9keTogJHNjb3BlLnBvc3RCb2R5XG5cblx0XHRcdH0pLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdCkge1xuXHRcdFx0XHQkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KVxuXHRcdFx0XHQkc2NvcGUucG9zdEJvZHkgPSBudWxsXG5cdFx0XHR9KVxuXHRcdH1cblx0fVxuXG5cdCRzY29wZS5yZW1vdmVQb3N0ID0gZnVuY3Rpb24oaWQsIGluZGV4KSB7XG5cdFx0UG9zdHNTdmMuZGVsZXRlUG9zdCh7aWQ6IGlkfSkuc3VjY2VzcyhmdW5jdGlvbigpe1xuXHRcdFx0YWxlcnQoJ1Bvc3QgaGFzIGJlZW4gZGVsZXRlZCcpXG5cdFx0XHQkc2NvcGUucG9zdHMuc3BsaWNlKGluZGV4LCAxKVxuXHRcdH0pLmVycm9yKGZ1bmN0aW9uKGVyKXtcblx0XHRcdGNvbnNvbGUubG9nKGVyKVxuXHRcdH0pXG5cdH1cblxuXHRQb3N0c1N2Yy5mZXRjaCgpLnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdHMpIHtcblx0XHQkc2NvcGUucG9zdHMgPSBwb3N0c1xuXHR9KS5lcnJvcihmdW5jdGlvbigpe1xuXHRcdCRzY29wZS5wb3N0c2VyciA9IFwiUGxlYXNlIGxvZyBpbiFcIlxuXHR9KVxufSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5zZXJ2aWNlKCdQb3N0c1N2YycsIGZ1bmN0aW9uKCRodHRwKXtcblxuXHRcdHRoaXMuZmV0Y2ggPSBmdW5jdGlvbigpIHsgXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJylcblx0XHR9XG5cdFx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpXG5cdFx0fVxuXG5cdFx0dGhpcy5kZWxldGVQb3N0ID0gZnVuY3Rpb24oaWQpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wdXQoJy9hcGkvcG9zdHMnLCBpZClcblxuXHRcdH1cblx0fSlcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3ZjKXtcblx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkLCBwYXNzd29yZDIpe1xuXHRcdGlmICghdXNlcm5hbWUpIHtcblx0XHRcdCRzY29wZS5yZWdpc3RlckVycm9yID0gXCJQbGVhc2UsIHNlbGVjdCB5b3VyIHVzZXJuYW1lLlwiXG5cdFx0XHRyZXR1cm4gbnVsbFxuXHRcdH1cblxuXHRcdGlmKCBwYXNzd29yZDIgIT0gcGFzc3dvcmQgfHwgIXBhc3N3b3JkMikge1xuXHRcdFx0JHNjb3BlLnJlZ2lzdGVyRXJyb3IgPSBcIlBhc3N3b3JkcyBkb24ndCBtYXRjaFwiXG5cdFx0XHRyZXR1cm4gbnVsbFxuXHRcdH1cblx0XHRVc2VyU3ZjLmNyZWF0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24odXNlcikge1xuXHRcdFx0XHQkc2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlci5kYXRhKVxuXHRcdH0sIGZ1bmN0aW9uKGVycikge1xuXHRcdFx0JHNjb3BlLnJlZ2lzdGVyRXJyb3IgPSBlcnIuZGF0YVxuXHRcdFx0JHNjb3BlLnVzZXJuYW1lID0gJydcblx0XHRcdCRzY29wZS5wYXNzd29yZCA9ICcnXG5cdFx0fSlcblx0fSBcbn0pXG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29uZmlnKGZ1bmN0aW9uKCRyb3V0ZVByb3ZpZGVyKSB7XG5cdFx0JHJvdXRlUHJvdmlkZXJcblx0XHQud2hlbignLycsIHsgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCcgfSlcblx0XHQud2hlbignL3JlZ2lzdGVyJywgeyBjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJyB9KVxuXHRcdC53aGVuKCcvbG9naW4nLCB7IGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLCB0ZW1wbGF0ZVVybDogJ2xvZ2luLmh0bWwnIH0pXG5cdFx0XG5cdH0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXNlclN2YycsIGZ1bmN0aW9uICgkaHR0cCwgJGxvY2F0aW9uKSB7XG5cdHZhciBzdmMgPSB0aGlzXG5cdHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKVxuXHR9XG5cblx0c3ZjLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xuXHRcdFx0dXNlcm5hbWU6IHVzZXJuYW1lLFxuXHRcdFx0cGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0fSkudGhlbihmdW5jdGlvbiAodmFsKSB7XG5cdFx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuID0gdmFsLmRhdGFcblx0XHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHZhbC5kYXRhXG5cdFx0XHRyZXR1cm4gc3ZjLmdldFVzZXIoKVxuXHRcdH0pXG5cdH1cblxuXHRzdmMuY3JlYXRlVXNlciA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuXHRcdFx0dXNlcm5hbWU6IHVzZXJuYW1lLFxuXHRcdFx0cGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0fSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICBcdFx0cmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG4gICAgXHR9KVxuXHR9XG5cblx0c3ZjLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG5cdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gJydcblx0XHQkbG9jYXRpb24ucGF0aCgnL2xvZ2luJylcblx0fVxuXG5cdHN2Yy5zZXRYQXV0aEhlYWRlciA9IGZ1bmN0aW9uKGhlYWRlcil7XG5cdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gaGVhZGVyXG5cdFx0cmV0dXJuIHN2Yy5nZXRVc2VyKClcblx0fVxufSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
